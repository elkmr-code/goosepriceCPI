# 🦢 鵝價消費者物價指數 (CPI) 視覺化儀表板

## 📋 專案概述

本專案是一個現代化的鵝價消費者物價指數視覺化分析系統，採用響應式設計與互動式圖表，提供直觀的數據分析體驗。系統具備完整的數據篩選、圖表展示、統計分析和數據匯出功能。

## ✨ 主要功能特色

### 📊 視覺化儀表板
- **2x2 統計網格佈局**: 顯示年份範圍、記錄數量、雛鵝平均 CPI、鵝肉平均 CPI
- **動態數據更新**: 統計數據根據選擇的年份範圍即時同步更新
- **響應式設計**: 桌面版採用 2x2 網格，手機版自動調整為單列佈局
- **美觀的卡片設計**: 毛玻璃效果、漸變背景、懸停動畫

### 📈 互動式圖表系統
- **CPI 趨勢線圖**: 雛鵝與鵝肉價格指數的時間序列變化分析
- **年度統計柱狀圖**: 分別展示雛鵝和鵝肉的年度平均 CPI 數據
- **年份範圍篩選**: 支援自訂起始和結束年份，圖表與統計同步更新

### 🔧 進階功能
- **數據匯出**: 支援 PNG 圖片匯出和 CSV 數據匯出
- **全螢幕模式**: 一鍵切換全螢幕瀏覽體驗
- **數據洞察分析**: 自動計算價格趨勢、市場波動性和相關性分析
- **即時載入狀態**: 美觀的載入動畫和狀態提示

### 🎯 數據分析功能
- **趨勢分析**: 比較最新年份與前一年的價格變化趨勢
- **波動性評估**: 計算價格變異程度，評估市場穩定性
- **相關性分析**: 分析雛鵝與鵝肉價格的關聯程度

## 🎨 設計特色

### 視覺設計
- **現代化界面**: 藍紫色漸變背景搭配毛玻璃效果
- **統一設計語言**: 圓角設計、多層次陰影、平滑過渡動畫
- **專業色彩系統**: 語義化色彩搭配，提升用戶體驗

### 用戶體驗優化
- **載入動畫**: 頁面載入時的優雅旋轉動畫效果
- **互動回饋**: 卡片懸停、按鈕點擊的視覺回饋動畫
- **狀態提示**: 操作成功/錯誤的即時視覺回饋訊息
- **無障礙設計**: 支援鍵盤操作和螢幕閱讀器

## 🛠️ 技術架構

### 後端技術棧
- **Node.js 14+** - JavaScript 執行環境
- **Express.js 4.16** - Web 應用程式框架
- **SQLite3 5.1** - 輕量級關聯式資料庫
- **Pug 3.0** - HTML 模板引擎

### 前端技術棧
- **HTML5** - 語義化標記結構
- **CSS3** - Grid Layout、Flexbox、CSS Animations
- **JavaScript ES6+** - 模組化、Promise、Async/Await
- **Chart.js 4.4.0** - 專業圖表視覺化庫
- **Bootstrap 5.3.0** - 響應式 UI 框架
- **Font Awesome 6.4.0** - 豐富圖標庫

## 📱 響應式設計

### 桌面版佈局 (>768px)
```
統計區塊 - 2x2 網格
┌─────────────┬─────────────┐
│ 年份範圍    │ 記錄數量    │
├─────────────┼─────────────┤
│ 雛鵝 CPI    │ 鵝肉 CPI    │
└─────────────┴─────────────┘
```

### 手機版佈局 (<768px)
```
統計區塊 - 單列排列
┌─────────────┐
│ 年份範圍    │
├─────────────┤
│ 記錄數量    │
├─────────────┤
│ 雛鵝 CPI    │
├─────────────┤
│ 鵝肉 CPI    │
└─────────────┘
```

## 🚀 安裝與執行

### 環境需求
- Node.js >= 14.x
- npm >= 6.x
- 現代瀏覽器 (Chrome 88+, Firefox 85+, Safari 14+)

### 快速安裝
```bash
# 1. 複製專案
git clone [repository-url]
cd goosepriceCPI

# 2. 安裝相依套件
npm install

# 3. 初始化資料庫（如果有 setup 腳本）
npm run setup-db

# 4. 啟動開發伺服器
npm start

# 5. 開啟瀏覽器訪問
http://localhost:3000
```

## 📊 API 端點說明

### 取得 CPI 原始資料
```http
GET /api/goose-cpi?startYear=2020&endYear=2023&limit=100
```
**參數說明:**
- `startYear` - 起始年份（可選）
- `endYear` - 結束年份（可選）
- `limit` - 資料筆數限制（預設 50）

### 取得年度統計摘要
```http
GET /api/cpi-summary?startYear=2020&endYear=2023
```
**功能:** 返回指定年份範圍的年度平均 CPI 統計數據

### 取得可用年份清單
```http
GET /api/years
```
**功能:** 返回資料庫中所有可用的年份列表

## 🎯 操作指南

### 基本操作流程
1. **選擇年份範圍**: 使用下拉選單設定起始和結束年份
2. **更新數據**: 點擊「更新圖表」按鈕載入篩選後的數據
3. **查看統計**: 觀察統計卡片中數值的即時變化
4. **分析趨勢**: 檢視圖表和數據洞察區塊的分析結果

### 進階功能使用
1. **圖表縮放**: 在趨勢圖上點擊拖拽可縮放特定區域
2. **匯出圖表**: 點擊下載按鈕匯出高解析度 PNG 圖表
3. **匯出數據**: 點擊 CSV 按鈕下載當前篩選的原始數據
4. **全螢幕模式**: 使用全螢幕按鈕獲得更佳的視覺體驗

### 鍵盤快捷鍵
- `Ctrl+R` - 重新載入所有數據
- `Escape` - 隱藏提示訊息
- `F11` - 切換瀏覽器全螢幕模式

## 📈 數據洞察功能

系統提供三大類自動化數據分析：

### 價格趨勢分析
- 比較最新年份與前一年的價格變化方向
- 識別雛鵝和鵝肉價格的上升或下降趨勢

### 市場波動性評估
- 計算價格變異係數評估市場穩定性
- 提供高、中等、低波動性等級判斷

### 相關性分析
- 計算雛鵝與鵝肉價格的皮爾遜相關係數
- 評估兩種產品價格的關聯強度

## 🔧 檔案結構

```
goosepriceCPI/
├── app.js                     # Express 主應用程式
├── package.json               # 專案設定與相依性
├── goose_cpi.db              # SQLite 資料庫檔案
├── public/
│   ├── index.html            # 主頁面（美化版）
│   ├── stylesheets/
│   │   └── style.css         # 2x2 網格樣式與響應式設計
│   └── javascripts/
│       ├── dashboard.js      # 儀表板工具與錯誤處理
│       └── cpi-charts.js     # 圖表邏輯與統計更新
├── views/                    # Pug 模板檔案（備用）
│   ├── layout.pug
│   └── index.pug
├── routes/                   # Express 路由
│   ├── index.js
│   └── users.js
├── bin/
│   └── www                   # 伺服器啟動腳本
└── scripts/                  # 工具腳本
    └── setup-database.js     # 資料庫初始化（如適用）
```

## 🎨 自訂與擴展

### 新增統計卡片
```html
<!-- 在 index.html 的 stats-grid 中新增 -->
<div class="stat-card">
    <div class="stat-icon">📊</div>
    <div class="stat-number" id="newStat">-</div>
    <div class="stat-label">新統計項目</div>
</div>
```

### 修改圖表樣式
```javascript
// 在 cpi-charts.js 中自訂圖表配置
const customChart = new Chart(ctx, {
    type: 'line',
    data: {...},
    options: {
        // 自訂選項
        responsive: true,
        plugins: {
            title: {
                display: true,
                text: '自訂圖表標題'
            }
        }
    }
});
```

### 新增 API 端點
```javascript
// 在 app.js 中新增路由
app.get('/api/custom-endpoint', (req, res) => {
    // 自訂邏輯
    res.json({data: 'custom response'});
});
```

## 🐛 故障排除

### 常見問題解決

**問題: 統計數據不更新**
- 檢查年份選擇是否正確
- 確認選定年份範圍內有對應數據
- 檢查網路連線狀態

**問題: 圖表無法顯示**
- 確認 Chart.js 庫載入正常
- 檢查瀏覽器開發者工具的錯誤訊息
- 驗證 API 端點回應是否正常

**問題: 篩選功能異常**
- 檢查後端 API 路由設定
- 驗證資料庫連線狀態
- 確認 SQL 查詢語法正確

### 偵錯模式
```bash
# 啟用詳細記錄
DEBUG=goosecpi:* npm start

# 檢查資料庫內容
sqlite3 goose_cpi.db "SELECT COUNT(*) FROM goose_cpi;"

# 檢查 API 回應
curl http://localhost:3000/api/goose-cpi
```

### 瀏覽器偵錯
1. 開啟開發者工具 (F12)
2. 查看 Console 標籤的錯誤訊息
3. 檢查 Network 標籤的 API 請求狀態
4. 驗證 Elements 標籤中 DOM 結構完整性

## 📋 更新日誌

### v2.1.0 (2024-12-09) - 最新版本
- ✅ 修復 cpi-charts.js 語法錯誤導致圖表無法載入
- ✅ 優化統計卡片 2x2 網格佈局的響應式設計
- ✅ 改善統計數據動態更新機制
- ✅ 移除冗餘的 API 端點展示區塊
- ✅ 強化錯誤處理和載入狀態顯示
- ✅ 更新中文繁體 README 文件

### v2.0.0
- 實現 2x2 統計網格佈局
- 新增年份範圍篩選功能
- 優化視覺設計和用戶體驗

### v1.0.0
- 基礎儀表板功能
- Chart.js 圖表整合
- RESTful API 建置

## 📄 授權與聲明

本專案僅供學術研究與教育用途使用。




